<script type="module">
  // Importar las funciones necesarias de Firebase SDK
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

  // Configuración de tu proyecto (Copia esto desde tu consola de Firebase)
  const firebaseConfig = {
    apiKey: "TU_API_KEY",
    authDomain: "tu-proyecto.firebaseapp.com",
    projectId: "tu-proyecto",
    storageBucket: "tu-proyecto.appspot.com",
    messagingSenderId: "tu-id",
    appId: "tu-app-id"
  };

  // Inicializar Firebase
  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  const form = document.getElementById('maquilaForm');

  form.onsubmit = async (e) => {
    e.preventDefault();
    
    const registro = {
      especie: document.getElementById('especie').value,
      peso: parseFloat(document.getElementById('peso').value),
      temp: parseFloat(document.getElementById('temp').value),
      fecha: new Date().toISOString(),
      estado_sincronizacion: "enviado_a_nube"
    };

    try {
      // Guardar directamente en la colección "recepciones" de Firestore
      const docRef = await addDoc(collection(db, "recepciones"), registro);
      console.log("Documento guardado con ID: ", docRef.id);
      
      form.reset();
      alert("Registro guardado exitosamente en la nube.");
    } catch (error) {
      console.error("Error al guardar:", error);
      alert("Error al conectar con la base de datos.");
    }
  };
</script>
